% -*- mode: latex -*-
\mansection{equil1}
\begin{mandesc}
  \short{equil1}{balancing (nonnegative) pair of matrices} \\ % 
\end{mandesc}
%\index{equil1}\label{equil1}
%-- Calling sequence section
\begin{calling_sequence}
\begin{verbatim}
  [T [,siz]]=equil1(P,Q [,tol])  
\end{verbatim}
\end{calling_sequence}
%-- Parameters
\begin{parameters}
  \begin{varlist}
    \vname{P, Q}: two non-negative symmetric matrices
    \vname{T}: nonsingular matrix
    \vname{siz}: vector of three integers
    \vname{tol}: threshold
  \end{varlist}
\end{parameters}
\begin{mandescription}
  \verb!equil1! computes \verb!t! such that:\verb!P1=T*P*T'!  and
  \verb!Q1=inv(T)'*Q*inv(T)! are as follows:\verb!P1 = diag(S1,S2,0,0)!  and
  \verb!Q1 = diag(S1,0,S3,0)! with \verb!S1,S2,S3! positive and diagonal
  matrices with respective dimensions \verb!siz=[n1,n2,n3]!\verb!tol! is a
  threshold for rank determination in SVD
\end{mandescription}
%--example 
\begin{examples}
  \begin{mintednsp}{nsp}
    S1=rand(2,2);S1=S1*S1';
    S2=rand(2,2);S2=S2*S2';
    S3=rand(2,2);S3=S3*S3';
    P=sysdiag(S1,S2,zeros(4,4));
    Q=sysdiag(S1,zeros(2,2),S3,zeros(2,2));
    X=rand(8,8);
    P=X*P*X';Q=inv(X)'*Q*inv(X);
    [T,siz]=equil1(P,Q);
    P1=clean(T*P*T')
    Q1=clean(inv(T)'*Q*inv(T))
  \end{mintednsp}
\end{examples}
%-- see also
\begin{manseealso}
  \manlink{balreal}{balreal} \manlink{minreal}{minreal} \manlink{equil}{equil} \manlink{hankelsv}{hankelsv}  
\end{manseealso}
%-- Author
\begin{authors}
  S. Steer 1987
\end{authors}
