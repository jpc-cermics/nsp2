% -*- mode: latex -*-
%% Scilab ( http://www.scilab.org/ ) - This file is part of Scilab
%% Copyright (C) 1987-2016 - F. Delebecque
%%
%% This program is free software; you can redistribute it and/or modify
%% it under the terms of the GNU General Public License as published by
%% the Free Software Foundation; either version 2 of the License, or
%% (at your option) any later version.
%%
%% This program is distributed in the hope that it will be useful,
%% but WITHOUT ANY WARRANTY; without even the implied warranty of
%% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
%% GNU General Public License for more details.
%%
%% You should have received a copy of the GNU General Public License
%% along with this program; if not, write to the Free Software
%% Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
%%
\mansection{linsolve}
\begin{mandesc}
  \short{linsolve}{linear equation solver} \\ % 
\end{mandesc}
%\index{linsolve}\label{linsolve}
%-- Calling sequence section
\begin{calling_sequence}
\begin{verbatim}
  [x0,kerA]=linsolve(A,b [,x0])  
\end{verbatim}
\end{calling_sequence}
%-- Parameters
\begin{parameters}
  \begin{varlist}
    \vname{A}: a \verb!na x ma! real matrix (possibly sparse)
    \vname{b}: a \verb!na x 1! vector (same row dimension as \verb!A!)
    \vname{x0}: a real vector
    \vname{kerA}: a \verb!ma x k! real matrix
  \end{varlist}
\end{parameters}
\begin{mandescription}
  \verb!linsolve!  computes all the solutions to \verb! A*x+b=0!.\verb!x0! is a particular solution (if any) and \verb! kerA= !nullspace
  of \verb!A!. Any \verb!x=x0+kerA*w! with arbitrary \verb!w! satisfies
  \verb! A*x+b=0!.
  If compatible \verb!x0! is given on entry, \verb!x0! is returned. If not
  a compatible \verb!x0!, if any, is returned.
\end{mandescription}
%--example 
\begin{examples}
  \begin{mintednsp}{nsp}
    A=rand(5,3)*rand(3,8);
    b=A*ones(8,1);[x,kerA]=linsolve(A,b); // compatible b
    if norm(A*x+b) > 1000*%eps then pause;end  
    if norm(A*kerA) > 1000*%eps then pause;end  
    // b=ones(5,1);[x,kerA]=linsolve(A,b);A*x+b   // incompatible b
    A=rand(5,5);[x,kerA]=linsolve(A,b), -inv(A)*b  //x is unique
  \end{mintednsp}
\end{examples}
%-- see also
\begin{manseealso}
  \manlink{inv}{inv} \manlink{pinv}{pinv} \manlink{colcomp}{colcomp} \manlink{im\_inv}{im-inv}  
\end{manseealso}
\begin{authors}
  François Delebecque
\end{authors}
