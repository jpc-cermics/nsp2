% -*- mode: latex -*-
%% Nsp
%% Copyright (C) 1998-2015 Jean-Philippe Chancelier Enpc/Cermics, Bruno Pinçon Esial/Iecn
%%
%% This library is free software; you can redistribute it and/or
%% modify it under the terms of the GNU General Public
%% License as published by the Free Software Foundation; either
%% version 2 of the License, or (at your option) any later version.
%%
%% This library is distributed in the hope that it will be useful,
%% but WITHOUT ANY WARRANTY; without even the implied warranty of
%% MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
%% General Public License for more details.
%%
%% You should have received a copy of the GNU General Public
%% License along with this library; if not, write to the
%% Free Software Foundation, Inc., 59 Temple Place - Suite 330,
%% Boston, MA 02111-1307, USA.
%%
 

\mansection{rank}
\begin{mandesc}
  \short{rank}{Numerical rank calculation}
\end{mandesc}

% -- Calling sequence section
\begin{calling_sequence}
\begin{verbatim}
rk=rank(A)
rk=rank(A,tol=rscal)
\end{verbatim}
\end{calling_sequence}
% -- Parameters
\begin{parameters}
  \begin{varlist}
    \vname{A}:  numerical matrix (say $m \times n$)
    \vname{tol=rscal}: optional named argument, \verb+rscal+ should be a real scalar. Default value of \verb+tol+ is \verb+max(m,n)*sv(1)*%eps+, where sv(1) is the largest singular value of \verb+A+. (as returned by \verb+sv=svd(A)+).
  \end{varlist}
\end{parameters}

\begin{mandescription}
This function computes the numerical rank of the matrix $A$, i.e. the number
of singular values larger than a given tolerance parameter. Note that the 
default value of tol is proportional to norm(A).
\end{mandescription}

\begin{examples}
\paragraph{example 1} a generic 10 x 5 matrix of rank 2:
  \begin{mintednsp}{nsp}
     A=rand(10,2)*rand(2,5);
     rk=rank(A);
     sv=svd(A);
     [m,n]=size(A);rscal=max(m,n)*sv(1)*%eps;
     rk=rank(A,tol=rscal);
  \end{mintednsp}
\paragraph{example 2} a 2 x 2 diagonal matrix with rank 1
  \begin{mintednsp}{nsp}
    A=diag([%eps 0]);
    rk=rank(A);
    rk=rank(A*%eps);  //One cannot just trust relative tolerance
    //if this A is the result of a computation, the rank is probably 0! 
  \end{mintednsp}

\end{examples}

\begin{manseealso}
  \manlink{svd}{svd}, \manlink{qr}{qr}
\end{manseealso}

% -- Authors
\begin{authors}
   interface : Bruno Pincon and Jean-Philippe Chancelier. 
\end{authors}
